
clear all
close all
range = (0:45:315)*pi/180;
addpath([cd '/CircStat2012a']);

    angle_deg = [0 45 90  90+45 180 180+45 180+90 180+90+45];
angle = [ 0 pi/4 pi/2 3*pi/4 pi -3*pi/4 3*pi/2 -pi/4];

mnread_scores = [11.96319096	4.326747092	6.714142953	5.461017824	7.145395717	17.32859716	8.421278324	4.318470444	9.471069635	11.43033252	4.660072835	1.527867316	9.952054668	0.287843588	1.224480459	3.923703427	11.8484174	0.168272967	1.875277189	0	0.042119428	0.983122203	20.92532903	12.80084196	11.47786611	3.672323092	0.884191905	0	5.656991596	2.730540357	4.687726396	5.700003211	3.208362147	7.26172466	17.51082647	13.0381578	8.234611457	0.602099399
12.51427941	16.37049209	13.39527863	14.47998977	13.37511915	21.39733449	11.5433033	9.508086301	16.10952152	21.88665495	6.935716334	6.913161375	24.56547383	10.89876773	3.9116321	13.35490779	9.318338804	2.694298317	4.713330736	1.396870931	0.025574972	9.458820588	16.73548121	20.71371385	21.11950797	3.213068347	4.074844929	2.343870513	11.9709522	12.27286861	9.030721669	8.444032926	5.597428462	13.21456343	19.04740331	22.76011172	16.47231764	8.701566056
11.89653271	27.26767984	50.17835143	57.07398329	27.79970199	16.76206721	11.02620853	11.35912998	14.46276326	12.29294461	18.25973143	19.34395832	23.75586357	22.9103033	28.26591864	28.05128716	20.13390338	29.99265314	17.25414219	20.45847652	5.032685641	42.18788929	4.685543315	15.21584694	18.08475001	20.80477419	17.39324213	14.08529934	24.88582799	26.70483401	24.92522218	17.83580661	35.38106098	19.0744791	8.893020738	22.71399584	18.00436357	17.07279954
0.083775918	3.913910988	14.7389762	10.61163818	9.87904431	7.331974314	4.669534145	6.704437818	1.22463331	0	7.038691369	10.8627204	0.163696099	7.359382951	19.20523505	5.571777452	6.306641445	5.932708191	30.78975074	31.86572547	34.75087151	11.90218784	0.005123587	2.317277152	0.749078134	15.13957703	15.29465507	19.71613072	11.3244292	10.43760353	13.39186446	17.97246396	11.06485213	4.594145421	0	0.430003355	4.087209482	7.308217549
3.302150635	4.79049643	2.571133839	0.190611863	9.082816988	3.864027918	3.552969544	5.262725838	0	0	2.743460704	3.955955949	0.090315089	0.255785179	8.249319634	1.810913603	3.167451457	0.106968702	18.72799323	22.11455304	32.82909508	4.587536789	0	0	0.801799558	4.738113329	8.050457793	11.62384273	1.307049303	1.80154458	4.770286846	6.361346307	2.796514278	1.794762762	0	0	1.555565871	1.49145633
1.85283733	7.574265291	0.085356402	0	4.221330763	0.340529773	8.653206263	12.36491844	0.876959255	0.005618054	9.10809902	16.15405449	0.008524639	2.721281463	14.97592	7.135467062	5.300153948	4.406859513	12.33581898	13.67711321	23.40871631	7.092618792	0.075145941	0	3.173048635	13.19960004	17.61198039	17.92656827	6.208992373	10.35621487	7.871073716	15.02790831	5.625820313	6.051945456	0.279081062	0.603064999	3.893324668	14.15701328
34.39011484	21.51237762	4.795936531	4.465269811	15.99084436	13.08769835	38.12833378	41.37547799	34.27302316	29.02367047	39.44401102	31.91274599	14.57909021	38.74961291	17.86644878	26.69271527	20.6182309	48.255242	8.67438396	9.263438386	3.910937057	16.92819871	29.62688748	25.12552388	26.86523189	30.50861655	24.22408653	29.41472052	25.56583468	24.80204587	20.81943578	17.79679563	22.03730623	34.30472002	25.54479704	16.64892234	34.46987281	39.52318511
23.99711819	14.24403064	7.520824019	7.717489262	12.50574673	19.88777078	14.00516611	9.106753201	23.58202985	25.3607794	11.8102173	9.329536165	26.88498189	16.81702288	6.301045337	13.45922823	23.30686266	8.44299717	5.629302972	1.223822438	0	6.859625785	27.94648944	23.82679622	17.72871768	8.723927416	12.46654126	4.889567906	13.07992267	10.89434816	14.50366895	10.86164305	14.28865546	13.70365915	28.72487138	23.80574393	13.2827345	11.14366274];

search_scores = [0.484387968	7.241415486	0.562191544	0	12.72526757	41.72508608	0	0	5.648469069	0.834602907	19.05028576	6.160609579	2.874164382	86.22016136	0.028766198	45.29596589	22.62133212	4.19726035	nan	nan	nan	nan	nan	nan	nan	nan	5.282927457	24.25391924	9.902728855	8.569790678	9.579785599	13.29948869	12.60469498	1.32153058	nan	nan	nan	nan
0	18.17614612	0.352337281	4.767686221	8.602473243	11.84696178	27.35434408	1.354091778	0.863447738	0.061057874	9.615910629	13.94181188	6.490465541	2.495863316	7.537412782	4.640647249	17.85294768	2.841389876	nan	nan	nan	nan	nan	nan	nan	nan	5.966725769	10.58760294	5.239570513	9.617750411	0	18.61775982	8.187948037	4.12470931	nan	nan	nan	nan
24.2666747	34.66695378	62.70643195	93.89161306	2.945111368	1.963552891	0	0.844060715	21.24947606	35.58827128	12.07866058	28.87247998	3.9066633	0.861456369	18.3147022	17.0199584	3.132014468	28.86697723	nan	nan	nan	nan	nan	nan	nan	nan	20.75447992	14.64877775	17.26095998	9.867094157	22.8144151	0	11.11669319	21.41329544	nan	nan	nan	nan
3.460140722	2.187608704	17.10054227	1.238027165	16.04570437	11.72351722	3.668556302	12.00573785	19.70657846	5.491285475	18.66547658	0.393067399	7.069686914	4.276112415	18.60504011	1.561373321	6.192503169	4.556417572	nan	nan	nan	nan	nan	nan	nan	nan	15.78425223	7.503028742	10.24631838	2.390640706	7.377252924	8.947513181	13.84863467	26.27340935	nan	nan	nan	nan
8.289934645	4.331045602	11.29256752	0	3.280300839	2.970513678	10.43378368	3.431179718	17.66550629	1.410184677	10.06982134	32.14136283	74.10246237	0	26.05013346	5.612145287	7.716350907	15.37982682	nan	nan	nan	nan	nan	nan	nan	nan	19.82592946	13.46619955	19.5556593	8.093884918	0.199079849	8.520699471	8.940570401	7.795826927	nan	nan	nan	nan
4.198816991	4.041168123	0.511591438	0.019165096	28.64080127	17.39040683	38.21017406	21.02623404	19.62179761	4.406192719	8.817499964	9.360543576	1.552806233	0	17.10317699	4.988428969	17.18886291	5.712668284	nan	nan	nan	nan	nan	nan	nan	nan	0.553431355	4.67910758	15.94593218	18.50002278	12.50632717	10.86254146	23.13459604	23.82769197	nan	nan	nan	nan
56.80851829	28.16541605	4.101188744	0.07114388	9.972519526	3.778064026	17.88452414	60.57025814	10.98808003	50.96221417	10.04030923	1.348333147	3.004616938	5.058426649	12.32196734	13.66709272	10.54830606	27.9131174	nan	nan	nan	nan	nan	nan	nan	nan	20.69437241	12.97119013	11.83389212	20.16118309	20.01712855	21.59186933	15.15484053	8.899681335	nan	nan	nan	nan
2.491526692	1.190246129	3.373149262	0.012364578	17.78782181	8.601897496	2.448617736	0.768437759	4.256644755	1.246190889	11.6620359	7.781791609	0.999134324	1.087979887	0.038800918	7.214388167	14.74768268	10.53234246	nan	nan	nan	nan	nan	nan	nan	nan	11.1378814	11.89017407	10.01493868	22.79963326	27.50601081	18.16012804	7.01202216	6.343855096	nan	nan	nan	nan];


PRL_test_scores =[12.0734361	0.718413244	15.28848022	3.234269119	6.31118517	12.81927877	0	0	0	0	1.676885433	50.26811495	0	68.22896939	0.375518	2.241272464	22.32855846	0	0.470440445	0	0.22717652	1.630074537	35.37601055	0.539148968	17.5506498	0.934852469	0.332175751	6.246273462	0.668564747	0	8.182103514	11.79540526	0	54.77967018	3.22121484	25.62151925	0.218237931	5.124515007
5.082283347	1.296977269	17.68222927	23.06873185	3.112987825	68.33854722	0	16.10701837	0.42511735	4.181125846	0	0	0.153280039	0	5.95439895	10.42656476	0	0	13.6735374	0	4.559051785	5.540224287	9.305620008	0.632524082	0.093549659	4.172310307	0.858120691	12.86341196	0.221160201	0	0	13.98698803	15.99287887	12.66558529	0	23.35853114	0	6.873366568
0.831954343	62.71208098	66.33695957	51.26137464	1.573535816	7.219223762	0.42161555	25.58060851	36.90549996	15.69844873	0	0	69.28103792	0	37.46721465	28.80086759	0.024618036	11.66047288	1.515792442	45.63644329	29.87794553	61.09837263	6.846103119	37.98362506	0	36.4273763	0	0.031004794	2.514108496	27.70336263	0	9.039617751	83.8612368	19.17545283	0	27.14783251	0	4.538494307
0	5.681285761	0.521811392	22.43562439	0	11.31011723	0	2.926343475	0	16.53317327	0	0	29.00807628	0	20.5910742	28.19665358	0	0	18.61828949	15.17312224	26.15845915	27.71397265	19.76161981	59.85450363	14.91750204	2.131746917	5.039257134	21.97285888	2.117545376	0.504627692	0	10.543576	0.145884331	1.95458232	0	15.48301154	0	11.27370275
2.594889703	0.44865333	0.170519545	0	0	0	13.01937085	0	28.31458684	0	0	0	0	0	16.80110507	0	0	0	0.40891145	20.59716599	23.02807958	3.095788861	0.818210683	0.291203748	8.62124311	18.60498057	0	9.512509242	10.46824953	0	0	3.531569018	0	2.032981887	0	0	1.915472393	4.464809975
3.254850352	1.587324124	0	0	15.42671034	0	25.1548578	12.54229281	0.168275618	6.566187091	77.47116229	21.60731473	0	0	10.98893228	30.3346416	5.437508655	3.302753392	40.0790904	10.69853163	1.439254974	0	0	0	34.23458953	17.04335201	10.968091	32.80187937	67.11322385	36.77503372	0	12.80215808	0	2.652068127	17.35309589	0.489511612	62.88381148	65.49846299
27.52550588	13.45463064	0	0	60.2658537	0	41.7038968	33.63571365	33.42485165	56.2679372	5.627721987	3.932352537	1.557605752	0	7.017172871	0	24.26722878	81.33785749	15.91165462	7.894736842	14.16819529	0	27.03636763	0.698994503	15.56226097	14.8460946	18.86355629	11.19392306	11.34526412	0.562764523	82.39782661	34.17670187	0	2.289808056	75.55930315	0	34.84979726	1.994082227
48.63708028	14.10063465	0	0	13.30972714	0.31283303	19.700259	9.208023186	0.761668586	0.753127872	15.22423029	24.19221779	0	31.77103061	0.80458398	0	47.94208607	3.698916237	9.322283751	0	0.541837167	0.921567036	0.856068192	0	9.020204892	5.839286821	63.93879913	5.378139235	5.551883675	34.45421143	9.420069874	4.123983991	0	4.449851311	3.866386113	7.899593946	0.132680937	0.232566172];
subj = [1:19; 1:19];




mnread_scores_pre_mean=[mnread_scores(:,1:2:end-1)];
mnread_scores_post_mean=[mnread_scores(:,2:2:end)];

search_scores_pre_mean=[search_scores(:,1:2:end-1)];
search_scores_post_mean=[search_scores(:,2:2:end)];

PRL_test_scores_pre_mean=[PRL_test_scores(:,1:2:end-1)];
PRL_test_scores_post_mean=[PRL_test_scores(:,2:2:end)];



for ui= 1:length(mnread_scores_pre_mean(1,:))

    theaverage=[]
    for sui=1:length(mnread_scores_pre_mean(:,1))
    newtheaverage=nanmean([mnread_scores_pre_mean(sui,ui), PRL_test_scores_pre_mean(sui,ui), search_scores_pre_mean(sui,ui)]);
    theaverage=[theaverage; newtheaverage];
    end
    average_pre{ui}=theaverage;

end






for ui= 1:length(mnread_scores_pre_mean(:,1))
    
    mnread_scores_pre_mean_av(ui)=mean(mnread_scores_pre_mean(ui,:))';
        search_scores_pre_mean_av(ui)=nanmean(search_scores_pre_mean(ui,:))';
    PRL_test_scores_pre_mean_av(ui)=mean(PRL_test_scores_pre_mean(ui,:))';

    
        mnread_scores_post_mean_av(ui)=mean(mnread_scores_post_mean(ui,:))';
        search_scores_post_mean_av(ui)=nanmean(search_scores_post_mean(ui,:))';
    PRL_test_scores_post_mean_av(ui)=mean(PRL_test_scores_post_mean(ui,:))';
end




 % average angle (across participants) for this specific task
 % average angle of this participant across task 
 % angle of the participant for this specific task


for ui=1:length(mnread_scores_pre_mean(1,:))
    
 %   for ui=1

figure


 % average angle (across participants) for this specific task
score_task_average = mnread_scores_pre_mean_av;
 % average angle of this participant across task 
score_participant_average = cell2mat(average_pre(:,ui))';
 % angle of the participant for this specific task
score_participant_in_task=mnread_scores_pre_mean(:,ui)';

Pax = polaraxes;
angler=angle-deg2rad(225)
flipscore=fliplr(score_task_average);
flipscore2=fliplr(score_participant_average);
flipscore3=fliplr(score_participant_in_task);


polarplot(Pax,[angle angle(1)], [score_participant_average score_participant_average(1)],'g-','LineWidth',2)
hold on
polarfill2(Pax, [angler angler(1)], 0, [flipscore2 flipscore2(1)],'green', 0.3);
hold on
polarplot(Pax,[angle angle(1)], [score_participant_in_task score_participant_in_task(1)],'b-','LineWidth',2)
hold on
polarfill2(Pax, [angler angler(1)], 0, [flipscore3 flipscore3(1)],'blue', 0.3);
hold on
polarplot(Pax,[angle angle(1)], [score_task_average score_task_average(1)],'r-','LineWidth',2)
hold on
polarfill2(Pax, [angler angler(1)], 0, [flipscore flipscore(1)],'red', 0.3);


d = Pax.ThetaDir;
Pax.ThetaDir = 'clockwise';
Pax.ThetaZeroLocation = 'top';
%title(Pax,'Average PRL location per task', 'fontsize',16)
Pax.RTickLabel = []; 
%Pax.ThetaTickLabel = [];
set(Pax,'FontSize',20)

Pax.LineWidth = 3;

%legend(Pax, 'task average','participant average', 'participant task average','location', 'Northeast')
legend(Pax, '1','2','3','location', 'Northeast')
legend(Pax, ['S' num2str(ui) ' mean pre'], ['S' num2str(ui) ' task mean pre'],'task mean pre','location', 'Northeast')

%title(Pax,'Average PRL location per task', 'fontsize',16)

title('Individual vs task-specific PRL', 'fontsize',16)

print([ 'S ' num2str(ui) '_polar_summary_perc2021newpre'], '-dpng', '-r300'); %<-Save as PNG with 300 DPI

    end

    
    
    tabu=[
(score_participant_average);
(score_participant_in_task);
    (score_task_average);

                ]'